{"version":3,"file":"index.modern.js","sources":["../src/index.tsx"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\nimport styled, { keyframes } from \"styled-components\";\n\ninterface TypoActionProps {\n  text: string;\n  pointText?: string;\n  className?: string;\n  pointColor?: string;\n  cursorText?: string;\n  cursorView?: boolean;\n  cursorColor?: string;\n  delay?: number;\n  speed?: number;\n}\n\nconst TypoAction: React.FC<TypoActionProps> = ({\n  text,\n  pointText = \"\",\n  className,\n  pointColor = \"red\",\n  cursorText = \"|\",\n  cursorView = true,\n  cursorColor = \"white\",\n  delay = 0,\n  speed = 100,\n}) => {\n  const [displayedText, setDisplayedText] = useState<string>(\"\");\n  const [animationPlayed, setAnimationPlayed] = useState<boolean>(false);\n  const [intervalId, setIntervalId] = useState<ReturnType<\n    typeof setInterval\n  > | null>(null);\n  const [playing, setPlaying] = useState<boolean>(false);\n  const [isVisible, setIsVisible] = useState<boolean>(false);\n  const textRef = useRef<HTMLSpanElement>(null);\n\n  const applyPointText = (inputText: string) => {\n    if (pointText) {\n      const targetIndex = inputText.indexOf(pointText);\n      if (targetIndex !== -1) {\n        return (\n          <>\n            {inputText.slice(0, targetIndex)}\n            <span style={{ color: pointColor }}>{pointText}</span>\n            {inputText.slice(targetIndex + pointText.length)}\n          </>\n        );\n      }\n    }\n    return inputText;\n  };\n\n  const handleScroll = (callback: () => void) => {\n    if (playing) return;\n\n    if (!animationPlayed && displayedText.length < text.length) {\n      let index = 0;\n\n      if (intervalId !== null) {\n        clearInterval(intervalId);\n      }\n\n      const startAnimation = () => {\n        const interval = setInterval(() => {\n          if (index < text.length) {\n            setDisplayedText((displayText) => text.slice(0, ++index));\n          } else {\n            clearInterval(interval);\n            setIntervalId(null);\n            callback();\n          }\n        }, speed);\n        setIntervalId(interval);\n      };\n\n      if (delay !== 0) {\n        setTimeout(startAnimation, delay);\n      } else {\n        startAnimation();\n      }\n\n      setAnimationPlayed(true);\n      setPlaying(true);\n    }\n  };\n\n  const reversedAnimation = (callback: () => void) => {\n    if (playing) return;\n\n    let reversedIndex = text.length;\n\n    if (intervalId !== null) {\n      clearInterval(intervalId);\n    }\n\n    const reversedInterval = setInterval(() => {\n      if (reversedIndex > -1) {\n        setDisplayedText((displayText) => {\n          if (displayText.length > 0) {\n            return text.slice(0, reversedIndex);\n          }\n          return displayText;\n        });\n        reversedIndex--;\n      } else {\n        clearInterval(reversedInterval);\n        setIntervalId(null);\n        callback();\n      }\n    }, speed);\n    setIntervalId(reversedInterval);\n\n    setPlaying(true);\n  };\n\n  useEffect(() => {\n    const observer = new IntersectionObserver(\n      (entries) => {\n        setIsVisible(entries[0].isIntersecting);\n      },\n      {\n        threshold: 1,\n      }\n    );\n\n    if (textRef.current) {\n      observer.observe(textRef.current);\n    }\n\n    return () => {\n      if (textRef.current) {\n        observer.unobserve(textRef.current);\n      }\n    };\n  }, [textRef]);\n\n  useEffect(() => {\n    if (isVisible) {\n      if (!animationPlayed && displayedText.length < text.length) {\n        handleScroll(() => {\n          setPlaying(false);\n          setAnimationPlayed(true); // 상태 추가\n        });\n      }\n    } else {\n      if (animationPlayed && displayedText.length === text.length) {\n        reversedAnimation(() => {\n          setPlaying(false);\n          setAnimationPlayed(false); // 상태 추가\n        });\n      }\n    }\n  }, [isVisible]);\n\n  useEffect(() => {\n    if (playing) return;\n\n    if (isVisible) {\n      if (!animationPlayed && displayedText.length < text.length) {\n        handleScroll(() => {\n          setPlaying(false);\n        });\n      }\n    } else {\n      if (animationPlayed && displayedText.length === text.length) {\n        reversedAnimation(() => {\n          setPlaying(false);\n        });\n      }\n    }\n    // animationPlayed가 변경되는 경우만 상태 업데이트와 관련된 효과를 다시 실행합니다.\n  }, [isVisible, animationPlayed]);\n\n  const blink = keyframes`\n  0%, 100% {\n    opacity: 1;\n  }\n  50% {\n    opacity: 0;\n  }\n`;\n\n  const Cursor = styled.span`\n    animation: ${blink} 1s step-end infinite;\n    color: ${cursorColor};\n  `;\n\n  return (\n    <span className={className} ref={textRef}>\n      <div></div>\n      {applyPointText(displayedText)}\n      {cursorView && <Cursor>{cursorText}</Cursor>}\n    </span>\n  );\n};\n\nexport default TypoAction;\n"],"names":["TypoAction","_ref","text","_ref$pointText","pointText","className","_ref$pointColor","pointColor","_ref$cursorText","cursorText","_ref$cursorView","cursorView","_ref$cursorColor","cursorColor","_ref$delay","delay","_ref$speed","speed","_useState","useState","displayedText","setDisplayedText","_useState2","animationPlayed","setAnimationPlayed","_useState3","intervalId","setIntervalId","_useState4","playing","setPlaying","_useState5","isVisible","setIsVisible","textRef","useRef","applyPointText","inputText","targetIndex","indexOf","React","createElement","Fragment","slice","style","color","length","handleScroll","callback","index","clearInterval","startAnimation","interval","setInterval","displayText","setTimeout","reversedAnimation","reversedIndex","reversedInterval","useEffect","observer","IntersectionObserver","entries","isIntersecting","threshold","current","observe","unobserve","blink","keyframes","_templateObject","_taggedTemplateLiteralLoose","Cursor","styled","span","_templateObject2","ref"],"mappings":"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"}